<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dash3D - Multi Dashboards</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/three@0.160.0/build/three.min.js"></script>
  <style>
    body { margin:0; font-family:'Poppins',sans-serif; background:#0f0f0f; color:#eee; }
    header { background:linear-gradient(90deg,#6a1b9a,#8e24aa,#d81b60); color:white; padding:20px; text-align:center; font-size:24px; font-weight:700; box-shadow:0 4px 12px rgba(0,0,0,.4); }
    main { display:grid; grid-template-columns:1fr 2fr; gap:20px; padding:20px; max-width:1400px; margin:auto; }
    form { background:#1e1e2f; padding:20px; border-radius:12px; box-shadow:0 4px 12px rgba(0,0,0,.4); margin-bottom:20px; }
    h3 { margin-top:0; color:#ffb74d; }
    label { font-weight:600; margin-top:10px; display:block; }
    input, select { width:100%; padding:10px; margin:6px 0; border:none; border-radius:6px; font-size:15px; background:#2c2c3c; color:white; }
    button { background:#8e24aa; color:white; border:none; padding:12px; width:100%; border-radius:8px; font-size:16px; cursor:pointer; margin-top:10px; font-weight:600; }
    button:hover { background:#d81b60; }
    .dashboard { background:#1e1e2f; padding:20px; border-radius:12px; box-shadow:0 4px 12px rgba(0,0,0,.4); }
    canvas { background:#121212; border-radius:12px; margin-top:15px; }
    .actions { display:flex; gap:10px; margin-top:15px; flex-wrap:wrap; }
  </style>
</head>
<body>
  <header>üìä Dash3D ‚Äî Multi Dashboards</header>

  <main>
    <!-- Formul√°rio -->
    <form id="dataForm">
      <h3>Adicionar Registro</h3>
      <label>Escolha o Dashboard</label>
      <select id="tipo">
        <option value="financeiro">üí∞ Financeiro</option>
        <option value="vendas">üõí Vendas</option>
        <option value="estoque">üì¶ Estoque</option>
        <option value="marketing">üì± Marketing</option>
      </select>

      <label>Categoria</label>
      <input type="text" id="categoria" placeholder="Ex: Receita, Produto, Campanha" required>

      <label>Valor</label>
      <input type="number" id="valor" placeholder="Digite um valor" required>

      <button type="submit">Salvar</button>
    </form>

    <!-- Dashboard -->
    <div class="dashboard">
      <h3 id="tituloDash">Dashboard em Tempo Real</h3>
      <canvas id="chart2d" height="150"></canvas>
      <canvas id="chart3d" height="300"></canvas>

      <div class="actions">
        <button onclick="exportarCSV()">‚¨áÔ∏è Exportar CSV</button>
        <button onclick="limparDados()">üóëÔ∏è Limpar Dados</button>
      </div>
    </div>
  </main>

  <script>
    // Dados por tipo de dashboard
    let registros = JSON.parse(localStorage.getItem("dash3D_multi")) || {
      financeiro:[], vendas:[], estoque:[], marketing:[]
    };
    let tipoAtual = "financeiro";

    const ctx2d = document.getElementById('chart2d').getContext('2d');
    let chart2d = new Chart(ctx2d, {
      type: 'bar',
      data: { labels: [], datasets: [{ label:'Valores', data:[], backgroundColor:['#8e24aa','#d81b60','#ffb74d','#29b6f6','#43a047'] }] },
      options: { responsive:true, plugins:{ legend:{labels:{color:'white'}}}, scales:{ x:{ticks:{color:'white'}}, y:{ticks:{color:'white'}} } }
    });

    // Gr√°fico 3D fake
    const canvas3d = document.getElementById('chart3d');
    const renderer = new THREE.WebGLRenderer({ canvas: canvas3d });
    renderer.setSize(canvas3d.clientWidth, 300);
    const scene = new THREE.Scene();
    const camera = new THREE.PerspectiveCamera(75, canvas3d.clientWidth/300, 0.1, 1000);
    camera.position.z = 5;
    const geometry = new THREE.BoxGeometry();
    const material = new THREE.MeshPhongMaterial({ color: 0x8e24aa, shininess:100 });
    const cube = new THREE.Mesh(geometry, material);
    scene.add(cube);
    const light = new THREE.PointLight(0xffffff, 1, 100);
    light.position.set(5,5,5);
    scene.add(light);

    function animate3D(){
      requestAnimationFrame(animate3D);
      cube.rotation.x += 0.01;
      cube.rotation.y += 0.01;
      let soma = registros[tipoAtual].reduce((a,b)=>a+b.valor,0);
      cube.scale.y = Math.max(0.5, soma/100); 
      renderer.render(scene, camera);
    }
    animate3D();

    // Atualizar gr√°ficos
    function atualizarGraficos(){
      const dados = registros[tipoAtual];
      chart2d.data.labels = dados.map(r=>r.categoria);
      chart2d.data.datasets[0].data = dados.map(r=>r.valor);
      chart2d.update();
      document.getElementById("tituloDash").innerText = "Dashboard " + tipoAtual.charAt(0).toUpperCase()+tipoAtual.slice(1);
    }

    // Formul√°rio
    document.getElementById("dataForm").addEventListener("submit", (e)=>{
      e.preventDefault();
      tipoAtual = document.getElementById("tipo").value;
      const categoria = document.getElementById("categoria").value;
      const valor = parseFloat(document.getElementById("valor").value);

      registros[tipoAtual].push({ categoria, valor });
      localStorage.setItem("dash3D_multi", JSON.stringify(registros));

      atualizarGraficos();
      e.target.reset();
    });

    document.getElementById("tipo").addEventListener("change",(e)=>{
      tipoAtual = e.target.value;
      atualizarGraficos();
    });

    // Exportar CSV
    function exportarCSV(){
      const dados = registros[tipoAtual];
      if(dados.length===0){ alert("Nenhum dado para exportar."); return; }
      let csv = "Categoria,Valor\n";
      dados.forEach(r=>{ csv+=`${r.categoria},${r.valor}\n`; });
      const blob = new Blob([csv],{type:"text/csv"});
      const link = document.createElement("a");
      link.href = URL.createObjectURL(blob);
      link.download = `dashboard_${tipoAtual}.csv`;
      link.click();
    }

    // Limpar
    function limparDados(){
      if(confirm("Deseja limpar este dashboard?")){
        registros[tipoAtual] = [];
        localStorage.setItem("dash3D_multi", JSON.stringify(registros));
        atualizarGraficos();
      }
    }

    atualizarGraficos();
  </script>
</body>
</html>