<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Stranger Squad Mobile</title>
    <style>
        body {
            background-color: #050505;
            margin: 0;
            overflow: hidden;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            user-select: none;
            /* Desabilita gestos padr√£o do celular (rolagem/zoom) */
            touch-action: none; 
            -webkit-touch-callout: none;
        }
        
        #ui {
            position: absolute; top: 10px; left: 2%; width: 96%;
            z-index: 100; display: flex; justify-content: space-between; pointer-events: none;
        }

        .player-card {
            background: linear-gradient(180deg, rgba(30,30,30,0.8), rgba(10,10,10,0.8));
            padding: 5px; border: 1px solid #444; border-radius: 8px;
            width: 45%; /* Responsivo */
            box-shadow: 0 2px 10px rgba(0,0,0,0.5);
        }

        .titulo { font-size: 10px; margin-bottom: 2px; text-transform: uppercase; font-weight: bold; letter-spacing: 1px; color:white;}
        .barra-vida-bg { width: 100%; height: 8px; background: #222; border-radius: 4px; overflow: hidden; }
        .vida-fill { height: 100%; transition: width 0.1s; }
        
        #vida-p1 { background: linear-gradient(90deg, #00ffff, #0088ff); box-shadow: 0 0 5px cyan; }
        #vida-p2 { background: linear-gradient(90deg, #00ff00, #008800); box-shadow: 0 0 5px lime; }

        #score-box {
            position: absolute; top: 15px; left: 50%; transform: translateX(-50%);
            text-align: center; color: white; z-index: 100; text-shadow: 0 0 10px #ff0000;
        }
        #score-val { font-size: 30px; font-weight: bold; font-family: 'Impact', sans-serif; }

        /* Mira (Visual apenas, ajuda a ver onde est√° tocando) */
        #mira {
            position: absolute; width: 40px; height: 40px;
            border: 2px solid rgba(255, 255, 255, 0.5); border-radius: 50%;
            transform: translate(-50%, -50%); pointer-events: none; z-index: 1000;
            display: none; /* Escondido no celular para n√£o atrapalhar, ativado no PC */
        }
        @media (hover: hover) { #mira { display: block; } } /* S√≥ mostra em telas com mouse */

        #vignette {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: radial-gradient(circle, transparent 50%, black 100%); pointer-events: none; z-index: 50;
        }
        
        /* Aviso de rota√ß√£o */
        #rotate-msg {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: black; z-index: 9999;
            color: white; display: none; align-items: center; justify-content: center; text-align: center; font-size: 20px;
        }
        @media screen and (orientation:portrait) { #rotate-msg { display: flex; } }

        canvas { display: block; }
    </style>
</head>
<body>

    <div id="rotate-msg">üîÑ POR FAVOR, VIRE O CELULAR<br>(JOGUE DEITADO)</div>
    <div id="vignette"></div>
    <div id="mira"></div>

    <div id="score-box">
        <div style="font-size: 10px; color: #aaa; letter-spacing: 2px;">STRANGER MOBILE</div>
        <div id="score-val">0</div>
    </div>

    <div id="ui">
        <div class="player-card" style="border-color: cyan;">
            <div class="titulo" style="color:cyan;">ONZE</div>
            <div class="barra-vida-bg"><div id="vida-p1" class="vida-fill" style="width: 100%;"></div></div>
        </div>
        <div class="player-card" style="border-color: lime;">
            <div class="titulo" style="color:lime;">WILL</div>
            <div class="barra-vida-bg"><div id="vida-p2" class="vida-fill" style="width: 100%;"></div></div>
        </div>
    </div>

    <canvas id="gameCanvas"></canvas>

    <script>
        const canvas = document.getElementById("gameCanvas");
        const ctx = canvas.getContext("2d");
        const mira = document.getElementById("mira");

        // Ajuste de tela responsivo
        function ajustar() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            chaoY = canvas.height - (canvas.height * 0.15); // Ch√£o proporcional
        }
        window.addEventListener('resize', ajustar);
        
        let chaoY;
        ajustar();

        // Estado do Jogo
        let mouse = { x: canvas.width/2, y: canvas.height/2 };
        let frame = 0;
        let score = 0;
        let gameRunning = true;
        let shake = 0;

        const p1 = { x: 200, y: chaoY, vida: 100, vivo: true, cooldown: 0 }; 
        const p2 = { x: 250, y: chaoY, vida: 100, vivo: true, cooldown: 0 }; 

        let monstros = [];
        let tiros = [];
        let particles = [];
        let nuvens = []; 
        
        for(let i=0; i<20; i++) nuvens.push({
            x: Math.random()*canvas.width, 
            y: Math.random()*canvas.height/2, 
            v: Math.random()*0.5+0.1, 
            size: Math.random()*2
        });

        // --- SISTEMA DE CONTROLES H√çBRIDO (TOUCH E MOUSE) ---

        function updateInput(x, y) {
            mouse.x = x;
            mouse.y = y;
            if(mira) { mira.style.left = x + 'px'; mira.style.top = y + 'px'; }
        }

        function acaoAtirar() {
            if(!gameRunning) return;
            if(p1.vivo && p1.cooldown <= 0) {
                tiros.push({x: p1.x+30, y: p1.y-50, vx: 20, vy: 0, dono: 1});
                p1.cooldown = 12; shake = 2;
            }
            if(p2.vivo && p2.cooldown <= 0) {
                tiros.push({x: p2.x+30, y: p2.y-50, vx: 18, vy: 0, dono: 2});
                p2.cooldown = 12; shake = 2;
            }
        }

        // Mouse (PC)
        window.addEventListener("mousemove", e => updateInput(e.clientX, e.clientY));
        window.addEventListener("mousedown", acaoAtirar);

        // Touch (Celular)
        canvas.addEventListener("touchmove", e => {
            e.preventDefault(); // Impede rolagem
            let touch = e.touches[0];
            updateInput(touch.clientX, touch.clientY);
        }, {passive: false});

        canvas.addEventListener("touchstart", e => {
            e.preventDefault(); // Impede zoom duplo
            let touch = e.touches[0];
            updateInput(touch.clientX, touch.clientY);
            acaoAtirar();
        }, {passive: false});


        function moverEsquadrao() {
            let alvoY = mouse.y;
            // Limites verticais
            if(alvoY > chaoY) alvoY = chaoY; 
            if(alvoY < canvas.height * 0.1) alvoY = canvas.height * 0.1;

            if(p1.vivo) {
                let alvoX_P1 = mouse.x - 35; 
                p1.x += (alvoX_P1 - p1.x) * 0.1; p1.y += (alvoY - p1.y) * 0.1;
                if(p1.cooldown > 0) p1.cooldown--;
                // Limites laterais
                if(p1.x < 0) p1.x = 0; if(p1.x > canvas.width) p1.x = canvas.width;
            }
            if(p2.vivo) {
                let alvoX_P2 = mouse.x + 35;
                p2.x += (alvoX_P2 - p2.x) * 0.08; p2.y += (alvoY - p2.y) * 0.08;
                if(p2.cooldown > 0) p2.cooldown--;
                if(p2.x < 0) p2.x = 0; if(p2.x > canvas.width) p2.x = canvas.width;
            }
        }

        // --- SISTEMA DE PART√çCULAS ---
        function criarExplosao(x, y, cor) {
            for(let i=0; i<10; i++) {
                particles.push({
                    x: x, y: y,
                    vx: (Math.random()-0.5) * 12,
                    vy: (Math.random()-0.5) * 12,
                    life: 20 + Math.random()*10,
                    color: cor,
                    size: Math.random() * 4 + 1
                });
            }
        }

        // --- DESENHOS ---

        function desenharOnze(p) {
            if(!p.vivo) return;
            ctx.save(); ctx.translate(p.x, p.y);
            
            // Aura
            if(p.cooldown > 5) { ctx.shadowBlur=20; ctx.shadowColor="cyan"; }
            
            // Sombra
            ctx.fillStyle = "rgba(0,0,0,0.5)"; ctx.beginPath(); ctx.ellipse(0, chaoY-p.y, 20, 5, 0, 0, Math.PI*2); ctx.fill();

            // Anima√ß√£o de andar
            let isMoving = Math.abs(mouse.x - p.x) > 5;
            let walk = isMoving ? Math.sin(frame*0.4)*8 : 0;
            let bob = isMoving ? Math.abs(Math.sin(frame*0.4))*3 : 0;

            ctx.translate(0, -bob);

            // Pernas
            ctx.fillStyle = "#1a2b45"; 
            ctx.fillRect(-10, -30, 8, 30+walk); ctx.fillRect(2, -30, 8, 30-walk);

            // Jaqueta (Detalhada)
            ctx.fillStyle = "#2a3b55"; ctx.fillRect(-13, -60, 26, 32); 
            ctx.fillStyle = "#3a4b65"; ctx.fillRect(-13, -60, 26, 6); 
            ctx.fillStyle = "#0a1b35"; ctx.fillRect(-13, -60, 3, 32); ctx.fillRect(10, -60, 3, 32); 

            // Cabe√ßa
            ctx.shadowBlur=0; 
            ctx.fillStyle="#ffdbac"; ctx.beginPath(); ctx.arc(0, -65, 11, 0, Math.PI*2); ctx.fill();
            ctx.fillStyle="#432"; ctx.beginPath(); ctx.arc(0, -67, 12, Math.PI, 0); ctx.fill();
            
            // Rosto e Sangue
            ctx.fillStyle="#210"; ctx.fillRect(-4, -66, 2, 2); ctx.fillRect(3, -66, 2, 2);
            ctx.fillStyle="#900"; ctx.fillRect(1, -63, 1, 4); 

            // Bra√ßo (Segue o tiro)
            ctx.fillStyle="#2a3b55"; ctx.fillRect(12, -60, 15, 8);
            ctx.fillStyle="#ffdbac"; ctx.fillRect(27, -60, 5, 8);

            ctx.restore();
        }

        function desenharWill(p) {
            if(!p.vivo) return;
            ctx.save(); ctx.translate(p.x, p.y);
            
            if(p.cooldown > 5) { ctx.shadowBlur=20; ctx.shadowColor="lime"; }
            
            ctx.fillStyle = "rgba(0,0,0,0.5)"; ctx.beginPath(); ctx.ellipse(0, chaoY-p.y, 20, 5, 0, 0, Math.PI*2); ctx.fill();

            let isMoving = Math.abs(mouse.x - p.x) > 5;
            let walk = isMoving ? Math.sin(frame*0.4+1)*8 : 0;
            let bob = isMoving ? Math.abs(Math.sin(frame*0.4+1))*3 : 0;

            ctx.translate(0, -bob);

            // Pernas
            ctx.fillStyle = "#432"; ctx.fillRect(-10, -30, 8, 30+walk); ctx.fillRect(2, -30, 8, 30-walk);

            // Roupas
            ctx.fillStyle = "#b00"; ctx.fillRect(-13, -60, 26, 32); 
            ctx.fillStyle = "#ddd"; ctx.fillRect(-13, -60, 8, 32); ctx.fillRect(5, -60, 8, 32); 

            // Cabe√ßa (BEGE CORRETO)
            ctx.shadowBlur=0; 
            ctx.fillStyle="#e8cda2"; ctx.beginPath(); ctx.arc(0, -65, 11, 0, Math.PI*2); ctx.fill(); 
            ctx.fillStyle="#543"; ctx.beginPath(); ctx.arc(0, -67, 12, Math.PI, 0); ctx.fill(); 
            ctx.fillRect(-12, -67, 24, 12); 
            ctx.fillStyle="#210"; ctx.fillRect(-4, -66, 2, 2); ctx.fillRect(3, -66, 2, 2);

            // Bra√ßo
            ctx.fillStyle="#b00"; ctx.fillRect(15, -60, 15, 8);
            ctx.fillStyle="#e8cda2"; ctx.fillRect(30, -60, 5, 8);

            ctx.restore();
        }

        function desenharMonstro(m) {
            ctx.save();
            let jumpY = 0;
            if(m.tipo === 'gorgon' && m.estado === 'pulando') {
                jumpY = Math.sin(m.puloTime * 0.1) * -150;
                m.puloTime++;
                if(m.puloTime > 30) { m.estado = 'andando'; m.puloTime = 0; }
            }
            ctx.translate(m.x, m.y + jumpY);
            let anim = Math.sin(frame*0.2 + m.id)*10;
            
            // Baba
            if(frame % 20 === 0) particles.push({x: m.x-10, y: m.y-70+jumpY, vx: -1, vy: 2, life: 25, color: "#0f0", size: 2});

            if(m.tipo === 'dog') {
                // DEMO-CAO (Cabe√ßa na Esquerda - CORRIGIDO)
                let runAnim = Math.sin(frame*0.8)*15;
                let breathe = Math.sin(frame*0.1)*2;

                // Corpo
                ctx.fillStyle = "#1a1a1a"; 
                ctx.beginPath();
                ctx.moveTo(-30, -20 + breathe); ctx.quadraticCurveTo(0, -40 + breathe, 30, -25 + breathe); 
                ctx.lineTo(25, -10); ctx.lineTo(-25, -10); ctx.fill();

                // Brilho
                ctx.strokeStyle = "#3a3a3a"; ctx.lineWidth = 2; ctx.lineCap = "round";
                ctx.beginPath(); ctx.moveTo(-25, -22+breathe); ctx.quadraticCurveTo(0, -38+breathe, 25, -27+breathe); ctx.stroke();

                // Patas
                ctx.strokeStyle = "#1a1a1a"; ctx.lineWidth = 6;
                ctx.beginPath(); ctx.moveTo(-25, -20); ctx.lineTo(-35, -10); ctx.lineTo(-40+runAnim, 0); ctx.stroke();
                ctx.beginPath(); ctx.moveTo(25, -20); ctx.lineTo(35, -10); ctx.lineTo(40-runAnim, 0); ctx.stroke();

                // Cabe√ßa
                ctx.translate(-30, -25 + breathe); ctx.rotate(Math.PI - 0.2); 
                ctx.fillStyle = "#500"; ctx.beginPath(); ctx.arc(0, 0, 7, 0, Math.PI*2); ctx.fill();
                
                let petalLen = 10;
                for(let i=0; i<5; i++) {
                    ctx.save(); ctx.rotate((i/5)*Math.PI*2);
                    ctx.fillStyle = "#777"; ctx.beginPath(); ctx.moveTo(0,0); ctx.lineTo(4, -3); ctx.lineTo(petalLen, 0); ctx.lineTo(4, 3); ctx.fill();
                    ctx.fillStyle = "#700"; ctx.beginPath(); ctx.moveTo(1,0); ctx.lineTo(petalLen-1, 0); ctx.lineTo(3, 1.5); ctx.fill();
                    ctx.fillStyle = "#fff"; ctx.beginPath(); ctx.arc(petalLen-1, 0, 1, 0, Math.PI*2); ctx.fill();
                    ctx.restore();
                }

            } else {
                // DEMOGORGON
                let skinColor = "#1a1a1a";
                ctx.fillStyle = skinColor; ctx.beginPath(); ctx.moveTo(-15,-85); ctx.lineTo(15,-80); ctx.lineTo(10,-40); ctx.lineTo(-10,-40); ctx.fill();
                ctx.strokeStyle = skinColor; ctx.lineWidth = 8; ctx.lineCap = "round";
                ctx.beginPath(); ctx.moveTo(5, -40); ctx.lineTo(25, 0-anim); ctx.stroke();
                ctx.beginPath(); ctx.moveTo(-5, -40); ctx.lineTo(-25, 0+anim); ctx.stroke();
                
                let armY = (m.estado === 'pulando') ? -100 : -40+anim;
                ctx.lineWidth = 6;
                ctx.beginPath(); ctx.moveTo(-10, -75); ctx.lineTo(-40, armY); ctx.stroke();
                ctx.beginPath(); ctx.moveTo(10, -75); ctx.lineTo(40, armY); ctx.stroke();
                
                ctx.fillStyle = "#aaa"; ctx.beginPath(); ctx.arc(-40, armY, 3, 0, Math.PI*2); ctx.fill(); ctx.beginPath(); ctx.arc(40, armY, 3, 0, Math.PI*2); ctx.fill();

                ctx.translate(0, -90);
                ctx.fillStyle = "#500"; ctx.beginPath(); ctx.arc(0, 0, 10, 0, Math.PI*2); ctx.fill();
                let petalLength = 16 + Math.abs(Math.sin(frame*0.15))*5;
                for(let i=0; i<5; i++) {
                    ctx.save(); ctx.rotate((i/5)*Math.PI*2);
                    ctx.fillStyle = "#777"; ctx.beginPath(); ctx.moveTo(0, 0); ctx.lineTo(8, -5); ctx.lineTo(petalLength, 0); ctx.lineTo(8, 5); ctx.fill();
                    ctx.fillStyle = "#700"; ctx.beginPath(); ctx.moveTo(2,0); ctx.lineTo(petalLength-2, 0); ctx.lineTo(5, 2); ctx.fill(); 
                    ctx.restore();
                }
            }
            ctx.restore();
        }

        function loop() {
            if(!gameRunning) return;
            
            // Screen Shake
            let dx = 0, dy = 0;
            if(shake > 0) { dx = (Math.random()-0.5)*shake; dy = (Math.random()-0.5)*shake; shake*=0.9; }

            ctx.clearRect(0,0,canvas.width, canvas.height);
            ctx.save(); ctx.translate(dx, dy);

            // Fundo
            let grad = ctx.createLinearGradient(0,0,0,canvas.height);
            grad.addColorStop(0, "#200505"); grad.addColorStop(1, "#000");
            ctx.fillStyle = grad; ctx.fillRect(0,0,canvas.width, canvas.height);

            // Devorador
            ctx.save(); ctx.translate(canvas.width/2, canvas.height/2);
            ctx.fillStyle = "rgba(40,0,0,0.2)";
            let pulso = Math.sin(frame*0.02)*20;
            ctx.beginPath(); ctx.ellipse(0, -100, 250+pulso, 120, 0, 0, Math.PI*2); ctx.fill();
            ctx.lineWidth=40; ctx.strokeStyle="rgba(40,0,0,0.15)";
            ctx.beginPath(); ctx.moveTo(-100,-100); ctx.lineTo(-400, canvas.height); ctx.moveTo(100,-100); ctx.lineTo(400, canvas.height); ctx.stroke();
            ctx.restore();

            // Poeira Fundo
            ctx.fillStyle = "rgba(255,255,255,0.1)";
            for(let n of nuvens) {
                n.x -= n.v; if(n.x < 0) n.x = canvas.width;
                ctx.beginPath(); ctx.arc(n.x, n.y, n.size, 0, Math.PI*2); ctx.fill();
            }

            // Ch√£o
            ctx.fillStyle = "#111"; ctx.fillRect(0, chaoY, canvas.width, canvas.height);
            ctx.strokeStyle = "#333"; ctx.lineWidth = 2;
            ctx.beginPath(); ctx.moveTo(0, chaoY); ctx.lineTo(canvas.width, chaoY); ctx.stroke();

            moverEsquadrao();
            if(p1.y < p2.y) { desenharOnze(p1); desenharWill(p2); } else { desenharWill(p2); desenharOnze(p1); }

            // SPAWN (60% Demogorgons / 40% C√£es)
            if(frame % 50 === 0) {
                let rand = Math.random();
                let type = rand < 0.4 ? 'dog' : 'gorgon';
                let speed = type === 'dog' ? 7 : 3;
                let hp = type === 'dog' ? 1 : 2;

                monstros.push({
                    x: canvas.width + 100, y: chaoY, v: speed, 
                    id: Math.random(), tipo: type, hp: hp, 
                    estado: 'andando', puloTime: 0
                });
            }

            for(let i=monstros.length-1; i>=0; i--) {
                let m = monstros[i]; m.x -= m.v;
                if(m.tipo === 'gorgon' && m.estado === 'andando' && m.x - Math.max(p1.x, p2.x) < 250 && Math.random() < 0.03) {
                    m.estado = 'pulando';
                }
                desenharMonstro(m);

                let hitP1 = p1.vivo && Math.abs(m.x - p1.x) < 35 && Math.abs(m.y - p1.y) < 55;
                let hitP2 = p2.vivo && Math.abs(m.x - p2.x) < 35 && Math.abs(m.y - p2.y) < 55;

                if(hitP1 || hitP2) {
                    if(hitP1) p1.vida -= 20; if(hitP2) p2.vida -= 20;
                    shake = 10;
                    criarExplosao(m.x, m.y-50, "#fff"); // Flash impacto
                    m.x = -1000;
                }
                if(m.x < -100) monstros.splice(i, 1);
            }

            for(let i=tiros.length-1; i>=0; i--) {
                let t = tiros[i]; t.x += t.vx; 
                ctx.save(); ctx.translate(t.x, t.y);
                ctx.fillStyle = t.dono===1?"cyan":"lime"; ctx.shadowBlur=15; ctx.shadowColor=ctx.fillStyle;
                ctx.beginPath(); ctx.arc(0, 0, 8, 0, Math.PI*2); ctx.fill(); ctx.restore();

                for(let m=monstros.length-1; m>=0; m--) {
                    let mon = monstros[m];
                    // Hitbox maior no pulo
                    let hitY = mon.estado === 'pulando' ? mon.y - 100 : mon.y - 40;
                    if(Math.abs(t.x - mon.x) < 50 && Math.abs(t.y - hitY) < 60) {
                        mon.hp--;
                        let bloodColor = mon.tipo === 'dog' ? "#0f0" : "#500";
                        criarExplosao(mon.x, hitY, bloodColor);
                        tiros.splice(i, 1);
                        if(mon.hp <= 0) { monstros.splice(m, 1); score++; }
                        break;
                    }
                }
                if(t.x > canvas.width) tiros.splice(i, 1);
            }

            for(let i=particles.length-1; i>=0; i--) {
                let p = particles[i]; p.life--; p.x+=p.vx; p.y+=p.vy;
                ctx.globalAlpha = p.life/30; ctx.fillStyle = p.color; 
                ctx.fillRect(p.x, p.y, p.size, p.size); ctx.globalAlpha=1;
                if(p.life<=0) particles.splice(i,1);
            }

            ctx.restore();

            // UI
            if(p1.vida <= 0) p1.vivo = false; if(p2.vida <= 0) p2.vivo = false;
            document.getElementById("score-val").innerText = score;
            document.getElementById("vida-p1").style.width = Math.max(0, p1.vida) + "%";
            document.getElementById("vida-p2").style.width = Math.max(0, p2.vida) + "%";

            if(!p1.vivo && !p2.vivo) {
                gameRunning = false;
                setTimeout(() => { if(confirm("FIM DE JOGO! Score: "+score+"\nJogar de novo?")) location.reload(); }, 100);
            }

            frame++; requestAnimationFrame(loop);
        }
        loop();
    </script>
</body>
</html>
